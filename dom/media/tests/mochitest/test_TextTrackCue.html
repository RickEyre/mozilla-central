<!DOCTYPE HTML>
<html>
<!--
https://bugzilla.mozilla.org/show_bug.cgi?id=833386
-->
<head>
	<title>Test for Bug 833386 - HTMLTrackElement</title>
	<script type="text/javascript" src="/MochiKit/MochiKit.js"></script>
	<script type="text/javascript" src="/tests/SimpleTest/SimpleTest.js"></script>
	<script type="text/javascript" src="/tests/content/html/content/test/reflect.js"></script>
	<link rel="stylesheet" type="text/css" href="/tests/SimpleTest/test.css"/>
</head>
<body>
<div id="videoDiv">
</div>
<pre id="test">
<script class="testbody" type="text/javascript">
	SimpleTest.waitForExplicitFinish();
	var videoDiv = document.getElementById("videoDiv");
	var WebvttEnabled = undefined;
	// Verify WebVTT support
	try{
  		WebvttEnabled = SpecialPowers.getBoolPref("media.webvtt.enabled");
	}catch (ex){
		// SpecialPowers failed, perhaps because WebVTT isn't compiled in
		console.log("media.webvtt.enabled pref not found; skipping WebVTT validation");
	}
	if (WebvttEnabled !== undefined) {
	   	// Testing with the pref set to True
		SpecialPowers.setBoolPref("media.webvtt.enabled", true);
		var videoElement = document.createElement('video');
		videoElement.src = "/tests/content/media/test/seek.webm";
		var trackElement = document.createElement('track');
		trackElement.src = "basic.vtt";
		trackElement.kind = "subtitles";
		videoDiv.appendChild(videoElement);
		videoElement.appendChild(trackElement);
		var textTrackCueList = trackElement.track.cues;
		var cue = textTrackCueList[0];
		is(cue.id, "Cue 1");
		is(cue.startTime, 11);
		is(cue.endTime, 13);
		is(cue.pauseOnExit, false);
		isnot(cue.track, undefined);
		cue.id = "Cue 01";
		cue.startTime = 10;
		cue.endTime = 14;
		cue.pauseOnExit = true;
		is(cue.id, "Cue 01");
		is(cue.startTime, 10);
		is(cue.endTime, 14);
		is(cue.pauseOnExit, true);
		cue.id = "";
		is(cue.id, "");
		videoDiv.removeChild(videoElement);
		//Testing with the pref set to False
		SpecialPowers.setBoolPref("media.webvtt.enabled", false);
		var videoElement = document.createElement('video');
		videoElement.src = "/tests/content/media/test/seek.webm";
		var trackElement = document.createElement('track');
		trackElement.src = "basic.vtt";
		trackElement.kind = "subtitles";
		videoDiv.appendChild(videoElement);
		videoElement.appendChild(trackElement);
		var textTrackCueList = trackElement.track.cues;
		var cue = textTrackCueList[0];
		is(cue.id, undefined);
		is(cue.startTime, undefined);
		is(cue.endTime, undefined);
		is(cue.pauseOnExit, undefined);
		is(cue.track, undefined);
		videoDiv.removeChild(videoElement);
		SimpleTest.finish();
	}else{
		var videoElement = document.createElement('video');
		videoElement.src = "/tests/content/media/test/seek.webm";
		var trackElement = document.createElement('track');
		trackElement.src = "basic.vtt";
		trackElement.kind = "subtitles";
		videoDiv.appendChild(videoElement);
		videoElement.appendChild(trackElement);
		var textTrackCueList = trackElement.track.cues;
		var cue = textTrackCueList[0];
		is(cue.id, undefined);
		is(cue.startTime, undefined);
		is(cue.endTime, undefined);
		is(cue.pauseOnExit, undefined);
		is(cue.track, undefined);
		videoDiv.removeChild(videoElement);
		SimpleTest.finish();
	}
</script>
</pre>	
</body>
</html>
